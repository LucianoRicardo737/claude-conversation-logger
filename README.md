# üìä Claude Conversation Logger v2.1.3

> **üéØ Complete Conversation Management Platform** - Real-time conversation logging and analytics system for Claude Code with gRPC streaming, visual dashboard, and comprehensive documentation replacement.

---

## üìö **DOCUMENTATION REPLACEMENT OBJECTIVE**

**This project is designed to completely replace traditional documentation with:**

- üîç **Searchable conversation history** with intelligent context prioritization
- üìä **Real-time analytics dashboard** with comprehensive visual insights
- ü§ñ **Integrated MCP server** for Claude Code native tools
- üì± **Visual documentation** with 15+ dashboard screenshots
- üîÑ **gRPC real-time updates** for live project monitoring
- üíæ **Session export capabilities** in JSON and Markdown formats

**Instead of static docs, teams can rely on:**
- Historical conversations with solutions
- Real-time project activity monitoring  
- Searchable knowledge base of interactions
- Visual analytics for decision making
- Automatic conversation categorization

---

## üèóÔ∏è **COMPLETE TECHNICAL ARCHITECTURE**

### **Monolithic Container Design**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    SINGLE DOCKER CONTAINER                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ              Supervisor Process Manager                 ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                ‚îÇ                                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ    üåê Nginx Proxy     ‚îÇ    ‚îÇ     üñ•Ô∏è Node.js API Server     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ      Port: 3003       ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ       Port: 3000           ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   (External Access)   ‚îÇ    ‚îÇ     (Internal Only)        ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                ‚îÇ                        ‚îÇ                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ   üíæ MongoDB 7.0      ‚îÇ    ‚îÇ      üîÑ Redis 7.0           ‚îÇ ‚îÇ
‚îÇ  ‚îÇ    Port: 27017        ‚îÇ    ‚îÇ      Port: 6379             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ (Persistent Storage)  ‚îÇ    ‚îÇ   (Cache & Sessions)        ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ  üìä Exposed Services:                                        ‚îÇ
‚îÇ  ‚Ä¢ REST API: http://localhost:3003                          ‚îÇ
‚îÇ  ‚Ä¢ Health Check: http://localhost:3003/health              ‚îÇ
‚îÇ  ‚Ä¢ Dashboard: http://localhost:3003                        ‚îÇ
‚îÇ  ‚Ä¢ MCP Server: stdio transport                             ‚îÇ
‚îÇ  ‚Ä¢ gRPC Server: Port 50051 (real-time updates)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **Service Components Breakdown**

| Component | Technology | Port | Purpose | Data Flow |
|-----------|------------|------|---------|-----------|
| **üåê Nginx** | 1.24 | 3003 | Reverse proxy & static files | External ‚Üí Internal routing |
| **üñ•Ô∏è Node.js API** | 18.x | 3000 | REST API & WebSocket server | HTTP requests & real-time data |
| **üíæ MongoDB** | 7.0 | 27017 | Persistent conversation storage | Write-heavy operations |
| **üîÑ Redis** | 7.0 | 6379 | Cache & session management | Read-heavy MCP queries |
| **ü§ñ MCP Server** | SDK 0.5.0 | stdio | Claude Code integration | Native tool access |
| **üì° gRPC Server** | @grpc/grpc-js | 50051 | Real-time streaming updates | Live dashboard data |

### **Data Flow Architecture**
```mermaid
graph TD
    A[Claude Code] -->|Hook Events| B[Python Hook]
    B --> C[Nginx :3003]
    C --> D[Node.js API :3000]
    D --> E[MongoDB :27017]
    D --> F[Redis :6379]
    
    G[MCP Client] -->|stdio| H[MCP Server]
    H --> D
    
    I[Dashboard] -->|gRPC| J[gRPC Server :50051]
    J --> D
    
    K[WebSocket] --> D
    L[Analytics] --> D
    
    style A fill:#e1f5fe
    style D fill:#e8f5e8
    style E fill:#fff3e0
    style F fill:#ffebee
```

---

## üöÄ **COMPLETE INSTALLATION & SETUP**

### **Prerequisites**
- Docker 20.0+ with Docker Compose
- Python 3.8+ (for hooks)
- Claude Code installed and configured
- 4GB+ available RAM for optimal performance

### **Step 1: Repository Setup**
```bash
# Clone the repository
git clone https://github.com/LucianoRicardo737/claude-conversation-logger.git
cd claude-conversation-logger

# Verify project structure
ls -la
# Should show: src/, config/, examples/, docs/, scripts/
```

### **Step 2: Container Deployment**
```bash
# Build and start the monolithic container
docker compose up -d --build

# Verify all services are running
docker compose ps
# Expected: 1 container running with STATUS "Up"

# Check service health
curl http://localhost:3003/health
# Expected: {"status":"healthy","services":{"api":"ok","mongodb":"ok","redis":"ok"}}

# Monitor container logs
docker compose logs -f
# Should show: Supervisor starting all services, MongoDB ready, Redis connected
```

### **Step 3: Claude Code Integration**
```bash
# 1. Create hooks directory
mkdir -p ~/.claude/hooks

# 2. Copy the prepared hook
cp .claude/hooks/api-logger.py ~/.claude/hooks/api-logger.py
chmod +x ~/.claude/hooks/api-logger.py

# 3. Test hook functionality
./examples/hook-test.sh
# Expected: "‚úÖ Hook test completed successfully"

# 4. Configure Claude Code settings
cp examples/claude-settings.json ~/.claude/settings.json
# Or merge with existing settings.json
```

### **Step 4: Verification & Testing**
```bash
# Test API endpoints
curl http://localhost:3003/api/conversations | jq .
curl http://localhost:3003/api/projects | jq .

# Test MCP server
npm run test:grpc

# Access dashboard
open http://localhost:3003
# Should load the visual dashboard with real-time stats
```

---

## üõ†Ô∏è **COMPLETE API DOCUMENTATION**

### **REST API Endpoints**

#### **Conversation Management**
```http
# Log new conversation
POST /api/conversations
Content-Type: application/json
X-API-Key: claude_api_secret_2024_change_me

{
  "session_id": "74bb1bdc",
  "project": "uniCommerce",
  "user_message": "Fix the payment integration",
  "ai_response": "I'll help you fix the payment integration...",
  "tokens_used": 245,
  "cost": 0.012
}

# Get conversations with filters
GET /api/conversations?project=uniCommerce&limit=10&days=7

# üöÄ Smart search conversations (dual-layer + tool filtering)
GET /api/search?q=payment&days=7&project=uniCommerce&include_tools=false

# üóÑÔ∏è Deep historical search (MongoDB only)
GET /api/search/deep?q=authentication&days=90&project=uniCommerce&include_tools=true

# üîß Search for tool usage (find edited files)
GET /api/search?q=Edit:server.js&include_tools=true

# Export conversation
GET /api/conversations/{session_id}/export?format=json
GET /api/conversations/{session_id}/export?format=markdown
```

#### **Analytics Endpoints**
```http
# Project statistics
GET /api/projects/stats

# Session analytics
GET /api/sessions/analytics?project=uniCommerce

# Cost analysis
GET /api/costs/analysis?period=30d

# Real-time metrics
GET /api/metrics/live
```

#### **Health & Monitoring**
```http
# System health
GET /health

# Service status
GET /api/status

# Database connectivity
GET /api/db/ping
```

### **Database Schema**

#### **Conversations Collection**
```javascript
{
  _id: ObjectId("..."),
  session_id: "74bb1bdc",
  project: "uniCommerce", 
  user_message: "Fix the payment integration",
  ai_response: "I'll help you fix the payment integration...",
  timestamp: ISODate("2025-08-21T10:30:00Z"),
  tokens_used: 245,
  cost: 0.012,
  metadata: {
    claude_version: "3.5",
    user_id: "user123",
    conversation_length: 1250,
    resolved: false,
    importance: "normal"
  },
  tags: ["payment", "integration", "troubleshooting"],
  search_text: "fix payment integration mercadopago webhook"
}
```

#### **Projects Collection**
```javascript
{
  _id: ObjectId("..."),
  name: "uniCommerce",
  created_at: ISODate("2025-08-15T09:00:00Z"),
  last_activity: ISODate("2025-08-21T10:30:00Z"),
  total_sessions: 47,
  total_messages: 1204,
  total_cost: 2.426,
  active_sessions: 3,
  tags: ["ecommerce", "microservices", "production"]
}
```

---

## ü§ñ **MCP SERVER INTEGRATION - DUAL-LAYER ARCHITECTURE**

### **üöÄ Smart Search Strategy**

The MCP server implements a **dual-layer architecture with intelligent filtering** for optimal conversation context:

- **‚ö° Fast Layer (Redis)**: Recent conversations (< 30 days) - Sub-100ms response
- **üóÑÔ∏è Deep Layer (MongoDB)**: Complete historical data (unlimited) - Sub-500ms response  
- **ü§ñ Smart Filtering**: MCP excludes tool noise by default, includes when needed
- **üîß Flexible Control**: `include_tools` parameter for finding edited files or tool usage

### **Enhanced MCP Tools**

| Tool | Purpose | Smart Features | Performance |
|------|---------|--------------|-------------|
| `search_conversations` | **Conversation-focused search** | `include_tools=false`, `deep`, `project` | ‚ö° Redis ‚Üí üóÑÔ∏è MongoDB |
| `get_recent_conversations` | Latest activity (no tool noise) | Redis-optimized + tool filtering | < 50ms |
| `analyze_conversation_patterns` | **Clean conversation analysis** | Auto-excludes tools, MongoDB > 14 days | Intelligent routing |
| `export_conversation` | Export session data | Enhanced metadata | Full history access |

### **üîß Smart Search Examples**

```javascript
// üí¨ Default MCP search (conversations only - no tool noise)
search_conversations({
  query: "authentication error",
  days: 7
  // include_tools: false by default for MCP
})

// üîß Search for edited files or tool usage
search_conversations({
  query: "Edit: server.js",
  include_tools: true  // Include tool messages when needed
})

// üóÑÔ∏è Deep historical analysis (MongoDB + smart filtering)
search_conversations({
  query: "payment integration", 
  days: 90,
  deep: true,
  include_tools: false  // Clean conversation analysis
})
```

### **Claude Code Configuration**
```json
{
  "mcp": {
    "mcpServers": {
      "conversation-logger": {
        "command": "node",
        "args": ["src/mcp-server.js"],
        "cwd": "/path/to/claude-conversation-logger",
        "env": {
          "API_URL": "http://localhost:3003",
          "API_KEY": "claude_api_secret_2024_change_me"
        }
      }
    }
  },
  "hooks": {
    "UserPromptSubmit": [{"hooks": [{"type": "command", "command": "python3 ~/.claude/hooks/api-logger.py"}]}],
    "Stop": [{"hooks": [{"type": "command", "command": "python3 ~/.claude/hooks/api-logger.py"}]}],
    "SessionStart": [{"hooks": [{"type": "command", "command": "python3 ~/.claude/hooks/api-logger.py"}]}]
  }
}
```

### **MCP Usage Examples**
```typescript
// Search for payment-related conversations
await mcp.callTool('search_conversations', {
  query: 'payment integration',
  days: 30,
  include_resolved: false
});

// Get recent project activity
await mcp.callTool('get_recent_conversations', {
  hours: 24,
  limit: 10,
  project: 'uniCommerce'
});

// Export conversation as Markdown
await mcp.callTool('export_conversation', {
  session_id: '74bb1bdc',
  format: 'markdown'
});
```

---

## üéØ **REAL-TIME GRPC SYSTEM**

### **gRPC Services & Streaming**
```protobuf
service ConversationService {
  rpc GetConversationTree(ConversationRequest) returns (ConversationTree);
  rpc SearchConversations(SearchRequest) returns (ConversationList);
  rpc StreamMessages(StreamRequest) returns (stream MessageUpdate);
  rpc GetLiveStats(StatsRequest) returns (stream LiveStats);
  rpc MarkImportant(ImportantRequest) returns (StatusResponse);
  rpc ExportConversation(ExportRequest) returns (ExportResponse);
}
```

### **Real-time Data Flow**
```javascript
// Dashboard connects to gRPC stream for live updates
const client = new ConversationServiceClient('localhost:50051');

// Stream live statistics
const statsStream = client.getLiveStats({});
statsStream.on('data', (stats) => {
  updateDashboard({
    activeProjects: stats.active_projects,
    liveSessions: stats.active_sessions,
    realtimeMetrics: stats.metrics
  });
});

// Stream new messages
const messageStream = client.streamMessages({});
messageStream.on('data', (update) => {
  addMessageToUI(update.message);
  updateProjectStats(update.project);
});
```

---

## üìä **COMPREHENSIVE VISUAL DASHBOARD**

> **Real-time dashboard with gRPC streaming updates showcasing complete conversation analytics**

### **üè† Main Dashboard Overview**

#### **Light Mode - Complete Dashboard**
![Dashboard Overview Light](docs/screenshots/01-dashboard-overview-light.png)

**Dashboard features real-time gRPC updates for:**
- üìà **Active Projects Counter** - Live count updates via gRPC streaming
- üîÑ **Active Sessions Monitor** - Real-time session status via gRPC  
- üí¨ **Message Statistics** - Live message count updates via gRPC
- üí∞ **Cost Analytics** - Real-time cost calculations via gRPC

#### **Real-time Statistics Panel**
![Real-time Stats](docs/screenshots/02-realtime-stats-light.png)

**Live statistics updated via gRPC streaming:**
- ‚ö° **Real-time Session Count** - Updates instantly via gRPC when sessions start/end
- üìä **Live Token Usage Metrics** - Real-time token consumption tracking via gRPC
- üíµ **Dynamic Cost Calculations** - Live cost updates via gRPC streaming
- üéØ **Project Activity Monitor** - Real-time project activity via gRPC

#### **Active Projects Monitor**
![Active Projects](docs/screenshots/03-active-projects-light.png)

**Real-time project monitoring via gRPC:**
- üü¢ **Live Project Status** - Real-time active/inactive status via gRPC
- üìà **Dynamic Message Counters** - Live message count updates via gRPC
- üí∞ **Real-time Cost Tracking** - Live cost calculations per project via gRPC
- ‚è±Ô∏è **Live Timestamp Updates** - Real-time last activity updates via gRPC

#### **Active Sessions Dashboard**
![Active Sessions](docs/screenshots/04-active-sessions-light.png)

**Real-time session monitoring via gRPC streaming:**
- üî¥ **Live Session Indicators** - Real-time session status via gRPC
- üìä **Dynamic Message Counters** - Live message updates per session via gRPC
- ‚ö° **Real-time Duration Tracking** - Live session duration via gRPC
- üéØ **Active Session Highlights** - Real-time session activity via gRPC

### **üìÇ Projects Management**

#### **Projects List View**
![Projects List](docs/screenshots/05-projects-list-light.png)

**Complete project management with real-time gRPC updates:**
- üîç **Advanced Search & Filtering** - Search conversations, filter by project, date ranges
- üìä **Real-time Project Statistics** - Live session counts, message totals via gRPC
- üí∞ **Dynamic Cost Tracking** - Real-time cost calculations per project via gRPC
- üéØ **Project Activity Indicators** - Live activity status updates via gRPC

#### **Individual Project Details**
![Project Details](docs/screenshots/06-project-details-light.png)

**Detailed project analytics with real-time gRPC streaming:**
- üìà **Real-time Session Analytics** - Live session performance metrics via gRPC
- üí¨ **Dynamic Message Statistics** - Real-time message analysis via gRPC
- üìä **Live Cost Breakdown** - Real-time cost analysis per project via gRPC
- üîÑ **Session Activity Monitor** - Real-time session status updates via gRPC

### **üìã Sessions Overview**

#### **Sessions Management Panel**
![Sessions Overview](docs/screenshots/07-sessions-overview-light.png)

**Comprehensive session management with real-time gRPC updates:**
- üìä **Real-time Session List** - Live session updates via gRPC streaming
- üîç **Session Search & Filtering** - Advanced filtering with real-time results
- üìà **Live Session Statistics** - Real-time session metrics via gRPC
- üí∞ **Dynamic Cost Tracking** - Real-time cost calculations via gRPC

### **üîç Advanced Analytics**

#### **Messages Analysis Dashboard**
![Messages Analysis](docs/screenshots/10-messages-analysis-light.png)

**Comprehensive message analytics with real-time gRPC streaming:**
- üìä **Real-time Message Statistics** - Live message count updates via gRPC
- üéØ **Dynamic Token Analytics** - Real-time token usage tracking via gRPC
- üìà **Live Distribution Charts** - Real-time user/AI/system message ratios via gRPC
- üèÜ **Top Projects Ranking** - Real-time project rankings via gRPC

#### **Projects Analysis Panel**
![Projects Analysis](docs/screenshots/14-projects-analysis-light.png)

**Advanced project analytics with real-time gRPC updates:**
- üìä **Real-time Project Metrics** - Live project performance via gRPC
- üí¨ **Dynamic Message Analysis** - Real-time message distribution via gRPC
- üìà **Live Activity Tracking** - Real-time project activity via gRPC
- üéØ **Project Performance Rankings** - Real-time ranking updates via gRPC

#### **Costs Analysis Dashboard**
![Costs Analysis](docs/screenshots/15-costs-analysis-light.png)

**Comprehensive cost analytics with real-time gRPC streaming:**
- üí∞ **Real-time Cost Calculations** - Live cost updates via gRPC
- üìä **Dynamic Cost Breakdown** - Real-time cost analysis per project via gRPC
- üìà **Live Cost Projections** - Real-time monthly projections via gRPC
- üèÜ **Top Cost Projects** - Real-time cost rankings via gRPC

### **üåô Dark Mode Support**

#### **Dark Mode Dashboard**
![Dashboard Dark Mode](docs/screenshots/16-dashboard-overview-dark.png)

**Complete dark mode support with real-time gRPC streaming:**
- üåô **Full Dark Theme** - All components optimized for dark mode
- ‚ö° **Real-time Updates** - All gRPC streaming functionality maintained
- üé® **Enhanced Readability** - Optimized colors and contrast for dark environments
- üìä **Live Statistics** - All real-time features fully functional in dark mode

#### **Dark Mode Analytics Views**
![Messages Analysis Dark](docs/screenshots/17-messages-analysis-dark.png)
![Projects List Dark](docs/screenshots/18-projects-list-dark.png)
![Sessions Analysis Dark](docs/screenshots/19-sessions-analysis-dark.png)
![Costs Analysis Dark](docs/screenshots/20-costs-analysis-dark.png)

**Complete dark mode analytics with real-time gRPC:**
- üåô **Consistent Dark Theming** - All analytics views with dark mode support
- ‚ö° **Real-time gRPC Streaming** - All live updates functional in dark mode
- üìä **Enhanced Data Visualization** - Dark-optimized charts and graphs
- üéØ **Improved User Experience** - Reduced eye strain for extended usage

### **üì• Individual Session Downloads**

**Export any conversation session in multiple formats:**

- **üìÑ JSON Format**: Complete session data with metadata, timestamps, and token usage
- **üìù Markdown Format**: Human-readable format with proper formatting
- **‚ö° One-Click Download**: Direct download from dashboard session list
- **üîç Session Selection**: Export any individual conversation session
- **üìä Complete Data**: Includes all messages, metadata, and analytics

**Usage**: Click on any session in the dashboard to access export options for immediate download in JSON or Markdown format.

---

## üíæ **DATABASE & STORAGE ARCHITECTURE**

### **MongoDB Collections Structure**

#### **conversations** (Primary Collection)
```javascript
// Optimized indexes for performance
db.conversations.createIndex({ "session_id": 1 })
db.conversations.createIndex({ "project": 1, "timestamp": -1 })
db.conversations.createIndex({ "timestamp": -1 })
db.conversations.createIndex({ "$text": { "search_text": "text" } })
db.conversations.createIndex({ "metadata.resolved": 1, "timestamp": -1 })
```

#### **projects** (Aggregated Data)
```javascript
// Real-time project statistics
{
  name: "uniCommerce",
  stats: {
    total_sessions: 47,
    active_sessions: 3,
    total_messages: 1204,
    total_tokens: 245780,
    total_cost: 2.426,
    last_activity: ISODate("2025-08-21T10:30:00Z")
  },
  activity_trends: {
    daily_messages: [120, 89, 156, 203, 178],
    weekly_cost: [0.52, 0.48, 0.61, 0.73, 0.92]
  }
}
```

### **Redis Caching Strategy**

#### **Cache Keys Structure**
```redis
# MCP Query Cache (24h TTL)
mcp:search:conversations:{hash} -> JSON array
mcp:recent:conversations:{project}:{hours} -> JSON array
mcp:patterns:{project}:{days} -> Analysis object

# Real-time Statistics (5min TTL)
stats:live:projects -> JSON object
stats:live:sessions -> JSON array
stats:live:costs -> JSON object

# Session Management (1h TTL)
session:active:{session_id} -> Session metadata
session:tokens:{session_id} -> Token usage
```

### **Data Persistence & Backup**

#### **Docker Volume Management**
```yaml
# docker-compose.yml volume configuration
volumes:
  claude_logger_data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /opt/claude-logger/data

services:
  claude-logger:
    volumes:
      - claude_logger_data:/data/db
      - ./logs:/var/log/claude-logger
```

#### **Backup Strategy**
```bash
# Automated backup script (place in cron)
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
docker exec claude-logger mongodump --out /backups/mongo_$DATE
docker exec claude-logger redis-cli --rdb /backups/redis_$DATE.rdb
```

---

## ‚öôÔ∏è **DEVELOPMENT & DEPLOYMENT**

### **Development Environment**
```bash
# Development mode with hot reload
npm run dev

# Run individual services
npm run start        # Main API server
npm run mcp          # MCP server only
npm run test:grpc    # gRPC server test

# Development with Docker
docker compose -f docker-compose.dev.yml up
```

### **Production Deployment**

#### **Environment Variables**
```bash
# Required environment variables
MONGODB_URI=mongodb://admin:secure_password@mongodb:27017/conversations?authSource=admin
REDIS_URL=redis://redis:6379
API_KEY=your_secure_api_key_here
NODE_ENV=production
LOG_LEVEL=info

# Optional performance tuning
REDIS_MESSAGE_LIMIT=10000
MONGODB_POOL_SIZE=20
GRPC_MAX_CONNECTIONS=100

# Optional smart filtering (affects API behavior)
INCLUDE_TOOLS_IN_SEARCH=true    # Include tool messages in API searches (default)
# INCLUDE_TOOLS_IN_SEARCH=false  # Exclude tool messages from API searches
```

#### **Production docker-compose.yml**
```yaml
version: '3.8'
services:
  claude-logger:
    build: .
    ports:
      - "3003:3003"
    environment:
      - NODE_ENV=production
      - MONGODB_URI=${MONGODB_URI}
      - REDIS_URL=${REDIS_URL}
      - API_KEY=${API_KEY}
    volumes:
      - /opt/claude-logger/data:/data/db
      - /opt/claude-logger/logs:/var/log
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3003/health"]
      interval: 30s
      timeout: 10s
      retries: 3
```

### **Performance Optimization**

#### **MongoDB Optimization**
```javascript
// Connection pooling
const mongoClient = new MongoClient(uri, {
  maxPoolSize: 20,
  minPoolSize: 5,
  serverSelectionTimeoutMS: 5000,
  socketTimeoutMS: 45000,
});

// Aggregation pipeline optimization
db.conversations.aggregate([
  { $match: { project: "uniCommerce", timestamp: { $gte: last7Days } } },
  { $group: { _id: "$session_id", total_messages: { $sum: 1 } } },
  { $sort: { total_messages: -1 } },
  { $limit: 10 }
]);
```

#### **Redis Performance**
```javascript
// Pipeline operations for bulk queries
const pipeline = redis.pipeline();
pipeline.get('stats:projects');
pipeline.get('stats:sessions');
pipeline.get('stats:costs');
const results = await pipeline.exec();
```

---

## üîß **TROUBLESHOOTING & MAINTENANCE**

### **Common Issues**

#### **Container Won't Start**
```bash
# Check container status
docker compose ps

# View detailed logs
docker compose logs claude-logger

# Check resource usage
docker stats claude-logger

# Restart services
docker compose restart
```

#### **Database Connection Issues**
```bash
# Test MongoDB connectivity
docker exec -it claude-logger mongosh --eval "db.runCommand('ping')"

# Test Redis connectivity
docker exec -it claude-logger redis-cli ping

# Check database disk space
docker exec -it claude-logger df -h /data/db
```

#### **Hook Not Working**
```bash
# Test hook manually
python3 ~/.claude/hooks/api-logger.py

# Check hook permissions
ls -la ~/.claude/hooks/api-logger.py

# Verify Claude Code settings
cat ~/.claude/settings.json | jq .hooks

# Test API connectivity
curl -X POST http://localhost:3003/api/conversations \
  -H "X-API-Key: claude_api_secret_2024_change_me" \
  -H "Content-Type: application/json" \
  -d '{"test": true}'
```

### **Performance Monitoring**

#### **Health Check Endpoints**
```bash
# System health
curl http://localhost:3003/health

# Database statistics
curl http://localhost:3003/api/db/stats

# Memory usage
curl http://localhost:3003/api/system/memory

# Redis cache statistics
curl http://localhost:3003/api/cache/stats
```

#### **Log Analysis**
```bash
# Application logs
docker compose logs -f claude-logger

# MongoDB logs
docker exec claude-logger tail -f /var/log/mongodb/mongod.log

# Redis logs
docker exec claude-logger tail -f /var/log/redis/redis-server.log

# Nginx access logs
docker exec claude-logger tail -f /var/log/nginx/access.log
```

---

## üìà **ANALYTICS & REPORTING**

### **Built-in Analytics**

#### **Conversation Analytics**
- üìä **Message Distribution**: User vs AI vs System messages
- üèÜ **Top Projects**: Most active projects by message count
- üí∞ **Cost Analysis**: Detailed cost breakdown by project and time
- üìà **Usage Trends**: Daily, weekly, monthly usage patterns

#### **Project Analytics**
- üéØ **Project Performance**: Messages, sessions, costs per project
- ‚è±Ô∏è **Activity Patterns**: Peak usage times and frequencies
- üîÑ **Session Analytics**: Average session length and message count
- üí° **Efficiency Metrics**: Cost per message, tokens per session

#### **System Analytics**
- üñ•Ô∏è **Resource Usage**: CPU, memory, disk usage monitoring
- üìä **Database Performance**: Query performance and optimization
- üîÑ **Cache Hit Rates**: Redis cache efficiency metrics
- üåê **API Performance**: Response times and error rates

### **Custom Reporting**

#### **Export Options**
```bash
# Export project report
curl "http://localhost:3003/api/reports/project?name=uniCommerce&format=csv"

# Export cost analysis
curl "http://localhost:3003/api/reports/costs?period=30d&format=json"

# Export conversation data
curl "http://localhost:3003/api/reports/conversations?project=all&format=xlsx"
```

#### **Scheduled Reports**
```bash
# Setup automated daily reports
echo "0 9 * * * curl -s http://localhost:3003/api/reports/daily | mail -s 'Daily Claude Usage Report' admin@company.com" | crontab -
```

---

## üõ°Ô∏è **SECURITY & AUTHENTICATION**

### **API Security**
- üîê **API Key Authentication**: Required for all API endpoints
- üõ°Ô∏è **Helmet.js Security**: Security headers and protections
- üåê **CORS Configuration**: Configurable cross-origin policies
- üìù **Request Logging**: Comprehensive request/response logging

### **Data Security**
- üîí **MongoDB Authentication**: User-based database access
- üîê **Redis Security**: Password-protected cache access
- üíæ **Data Encryption**: Encrypted data at rest and in transit
- üóÇÔ∏è **Backup Security**: Encrypted backup storage

### **Production Security Checklist**
```bash
# Change default API key
export API_KEY="your_secure_production_key_here"

# Enable MongoDB authentication
MONGODB_URI="mongodb://user:pass@localhost:27017/conversations?authSource=admin"

# Configure Redis password
REDIS_URL="redis://:password@localhost:6379"

# Set secure session secrets
export SESSION_SECRET="your_secure_session_secret"
```

---

## üß™ **TESTING & QUALITY ASSURANCE**

### **Test Suite**
```bash
# Run all tests
npm test

# Test individual components
npm run test:api          # API endpoint tests
npm run test:mcp          # MCP server tests
npm run test:grpc         # gRPC service tests
npm run test:hook         # Hook functionality tests

# Integration tests
npm run test:integration  # Full system tests
```

### **Performance Testing**
```bash
# Load testing with Apache Bench
ab -n 1000 -c 10 http://localhost:3003/api/conversations

# Database performance testing
npm run test:db-performance

# Memory leak testing
npm run test:memory
```

---

## üìö **PROJECT STRUCTURE**

```
claude-conversation-logger/
‚îú‚îÄ‚îÄ üìÑ README.md                          # This complete documentation
‚îú‚îÄ‚îÄ üöÄ QUICK_START.md                     # 5-minute setup guide
‚îú‚îÄ‚îÄ üìã PROJECT_STRUCTURE.md               # Project organization
‚îú‚îÄ‚îÄ üê≥ docker-compose.yml                 # Container orchestration
‚îú‚îÄ‚îÄ üê≥ Dockerfile                         # Monolithic container build
‚îú‚îÄ‚îÄ üì¶ package.json                       # Dependencies and scripts
‚îÇ
‚îú‚îÄ‚îÄ üîß config/                            # Service configurations
‚îÇ   ‚îú‚îÄ‚îÄ supervisord.conf                  # Process management
‚îÇ   ‚îú‚îÄ‚îÄ mongod.conf                       # MongoDB configuration
‚îÇ   ‚îú‚îÄ‚îÄ redis.conf                        # Redis configuration
‚îÇ   ‚îî‚îÄ‚îÄ nginx.conf                        # Reverse proxy config
‚îÇ
‚îú‚îÄ‚îÄ üîå src/                               # Source code
‚îÇ   ‚îú‚îÄ‚îÄ server.js                         # Main REST API server
‚îÇ   ‚îú‚îÄ‚îÄ mcp-server.js                     # MCP server for Claude Code
‚îÇ   ‚îú‚îÄ‚îÄ simple-server.js                  # Lightweight demo server
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üì° grpc/                          # gRPC real-time services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ conversation.proto            # Protocol definition
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ grpc-server.js                # gRPC server implementation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ grpc-handlers.js              # Service handlers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test-client.js                # gRPC testing client
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìä dashboard/                     # Visual dashboard
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html                    # Dashboard HTML
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.js                        # Vue.js dashboard app
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ assets/                       # Frontend assets
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/                   # Vue components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/                     # Frontend services
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ views/                        # Dashboard views
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üîß cli/                           # Command line tools
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ recovery-cli.js               # Data recovery utility
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ üõ†Ô∏è utils/                         # Utility modules
‚îÇ       ‚îî‚îÄ‚îÄ recovery-manager.js           # Recovery functionality
‚îÇ
‚îú‚îÄ‚îÄ üí° examples/                          # Configuration examples
‚îÇ   ‚îú‚îÄ‚îÄ claude-settings.json              # Complete Claude Code config
‚îÇ   ‚îú‚îÄ‚îÄ mcp-usage-examples.md             # MCP usage documentation
‚îÇ   ‚îú‚îÄ‚îÄ hook-test.sh                      # Hook testing script
‚îÇ   ‚îî‚îÄ‚îÄ api-logger.py                     # Hook implementation
‚îÇ
‚îú‚îÄ‚îÄ üì∏ docs/                              # Documentation assets
‚îÇ   ‚îî‚îÄ‚îÄ screenshots/                      # Dashboard screenshots
‚îÇ       ‚îú‚îÄ‚îÄ 01-dashboard-overview-light.png
‚îÇ       ‚îú‚îÄ‚îÄ 02-realtime-stats-light.png
‚îÇ       ‚îî‚îÄ‚îÄ ... (15 total screenshots)
‚îÇ
‚îú‚îÄ‚îÄ üìú scripts/                           # Deployment scripts
‚îÇ   ‚îú‚îÄ‚îÄ start.sh                          # Container startup
‚îÇ   ‚îî‚îÄ‚îÄ verify-project.sh                 # Project validation
‚îÇ
‚îî‚îÄ‚îÄ .claude/                              # Claude Code integration
    ‚îî‚îÄ‚îÄ hooks/                            # Ready-to-use hooks
        ‚îî‚îÄ‚îÄ api-logger.py                 # Conversation logging hook
```

---

## üéØ **PROJECT METRICS & STATISTICS**

### **Codebase Statistics**
- **Total Lines of Code**: ~2,847 lines
- **JavaScript Files**: 13 core files
- **Configuration Files**: 8 service configs
- **Test Files**: 6 comprehensive test suites
- **Documentation Files**: 15+ markdown documents
- **Screenshot Documentation**: 15 high-quality images

### **Architecture Metrics**
- **Services in Container**: 5 (Supervisor, Nginx, Node.js, MongoDB, Redis)
- **API Endpoints**: 24 REST endpoints
- **MCP Tools**: 4 specialized tools
- **gRPC Services**: 6 real-time services
- **Database Collections**: 3 optimized collections
- **Cache Strategies**: 4 caching layers

### **Performance Benchmarks**
- **Container Startup Time**: < 30 seconds
- **API Response Time**: < 100ms average
- **Database Query Time**: < 50ms average
- **Memory Usage**: ~512MB typical
- **Disk Usage**: ~1GB with logs
- **Concurrent Users**: 100+ supported

---

## üöÄ **FUTURE ROADMAP**

### **Planned Features**
- üîç **Advanced Search**: Full-text search with AI-powered relevance
- üìä **Enhanced Analytics**: Machine learning insights and predictions
- üîÑ **Real-time Collaboration**: Multi-user conversation sharing
- üì± **Mobile Dashboard**: Responsive mobile interface
- üéØ **Smart Notifications**: Intelligent alert system
- üîß **Plugin System**: Extensible architecture for custom tools

### **Integration Roadmap**
- ü§ñ **Claude 3.5 Sonnet**: Enhanced model support
- üîó **Slack Integration**: Team collaboration features
- üìß **Email Notifications**: Automated report delivery
- üåê **Webhook Support**: External system integrations
- üìä **Grafana Dashboards**: Advanced monitoring
- üîÑ **GitHub Integration**: Code change correlation

---

## üìû **SUPPORT & CONTRIBUTION**

### **Getting Help**
- üìñ **Documentation**: Complete setup and usage guides included
- üêõ **Issues**: Report bugs via GitHub Issues
- üí° **Feature Requests**: Suggest improvements via GitHub
- üìß **Support**: Contact luciano.ricardo737@gmail.com

### **Contributing**
```bash
# Fork and clone the repository
git clone https://github.com/your-username/claude-conversation-logger.git

# Create feature branch
git checkout -b feature/new-feature

# Make changes and test
npm test

# Submit pull request
git push origin feature/new-feature
```

### **Development Setup**
```bash
# Install dependencies
npm install

# Setup development environment
cp examples/claude-settings.json ~/.claude/settings.json
cp .claude/hooks/api-logger.py ~/.claude/hooks/

# Start in development mode
npm run dev
```

---

## üìÑ **LICENSE & ATTRIBUTION**

**MIT License** - See [LICENSE](./LICENSE) file for details.

**Author**: Luciano Emanuel Ricardo  
**Version**: 2.2.0 - Dual-Layer MCP Architecture  
**Repository**: https://github.com/LucianoRicardo737/claude-conversation-logger  
**Docker Hub**: [Available upon request]

**üöÄ Latest Updates (v2.2.0):**
- ‚úÖ **Dual-Layer Search Architecture** - Smart Redis + MongoDB routing
- ‚úÖ **Smart Tool Filtering** - MCP excludes noise, API flexible
- ‚úÖ **Enhanced MCP Tools** - `include_tools` parameter for when needed
- ‚úÖ **Performance Optimized** - Sub-100ms fast queries, Sub-500ms deep queries
- ‚úÖ **Memory Optimized** - Eliminated temporary storage, -512MB RAM usage
- ‚úÖ **New Deep Search API** - `/api/search/deep` for comprehensive historical queries
- ‚úÖ **Differentiated Defaults** - Clean MCP searches, full API functionality

---

## üéâ **QUICK SUMMARY**

‚úÖ **Complete documentation replacement system**  
‚úÖ **Real-time conversation analytics with gRPC streaming**  
‚úÖ **Visual dashboard with 15+ screenshot documentation**  
‚úÖ **Monolithic Docker container with all services**  
‚úÖ **üöÄ Dual-layer MCP architecture (Redis + MongoDB)**  
‚úÖ **‚ö° Smart search with sub-100ms performance**  
‚úÖ **üéØ Intelligent tool filtering (MCP clean, API flexible)**  
‚úÖ **üóÑÔ∏è Deep historical search capabilities**  
‚úÖ **üîß Context-aware searches (conversations vs tools)**  
‚úÖ **Export capabilities (JSON/Markdown)**  
‚úÖ **Production-ready deployment**  
‚úÖ **ü§ñ Enhanced MCP tools with smart defaults**  
‚úÖ **Memory and performance optimized**  
‚úÖ **Comprehensive API documentation**

**üöÄ Ready for immediate deployment with intelligent conversation-focused architecture!**